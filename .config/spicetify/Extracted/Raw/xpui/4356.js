"use strict";(("undefined"!=typeof self?self:global).webpackChunkopen=("undefined"!=typeof self?self:global).webpackChunkopen||[]).push([[4356,205],{80205:(e,s,n)=>{n.r(s),n.d(s,{EPISODE_SPONSORS_SHELF_TESTID:()=>g,EpisodeSponsorsWrapper:()=>T,SEE_ALL_EPISODE_SPONSORS_TESTID:()=>_,default:()=>k});var o=n(59496),t=n(97533),r=n(54940);var i=n(83834),a=n(4637);const d=(0,o.lazy)((()=>n.e(4127).then(n.bind(n,24127))));function u({fetchedEpisodeSponsorsData:e,fireTrackingEvent:s,numberOfSponsorsToDisplay:n,firedViewedEvents:t,version:r,reason:u,uri:p}){const{displayedEpisodeSponsorsData:c}=function({fetchedEpisodeSponsorsData:e,numberOfSponsorsToDisplay:s}){return(0,o.useMemo)((()=>({displayedEpisodeSponsorsData:e.slice(0,s)})),[e,s])}({fetchedEpisodeSponsorsData:e,numberOfSponsorsToDisplay:n}),l=(0,i.X)({displayedEpisodeSponsorsData:c,uri:p,reason:u}),f=(0,o.useMemo)((()=>c.map(((e,n)=>(0,a.jsx)(d,{fireTrackingEvent:s,firedViewedEvents:t,version:r,onClick:()=>l({ui_navigate:c.map((({clickthrough:e},s)=>n===s?e:"")),navigate_to_external_uri:c.map(((...[,e])=>n===e))}),...e},`${e.metadata.lineitem_id}-${n}`)))),[c,s,t,r,l]);return{displayedEpisodeSponsorsData:c,displayedSponsors:f}}var p=n(86447),c=n(46721);var l=n(1568);function f({firedViewedEvents:e}){const s=(0,o.useRef)();return{firedViewedEvents:s.current=e??s.current??new Set}}function S({uri:e,getEpisodeSponsors:s,fireTrackingEvent:n,numberOfSponsorsToDisplay:t,version:r,reason:i}){const{state:a}=(0,p.b)(),d=function({uri:e,episodeBase62Id:s}){return(0,o.useMemo)((()=>{const n=(0,c.EC)(e),o=s||n?.id;return{uri:(0,c.YD)(o).toURI(),episodeBase62Id:o}}),[e,s])}({...a?.[p.H],uri:e}),{fetchedEpisodeSponsorsData:S}=(0,l.m)({...a,...d,getEpisodeSponsors:s,version:r}),{firedViewedEvents:v}=f({...a?.[p.H]}),E=u({fetchedEpisodeSponsorsData:S,fireTrackingEvent:n,numberOfSponsorsToDisplay:t,firedViewedEvents:v,version:r,reason:i,...d});return{...d,fetchedEpisodeSponsorsData:S,...E,firedViewedEvents:v,reason:i}}const v=3;var E=n(47643),h=n(65313),b=n(33134),m=n(88514);function D(e){const s="episode_page";if(!e.state||!e.uri)return null;const n=(0,m.ct)({leavebehindAds:e.state.fetchedEpisodeSponsorsData,requestId:"---"},e.uri);return(0,a.jsx)("div",{children:(0,a.jsx)(E.w,{entityType:"podcast",leavebehinds:n,surface:s,uri:e.uri,seeAllButton:n.length>m.d9?(0,a.jsx)(h.j,{leavebehinds:n,surface:s,uri:e.uri,pathname:(0,b.e)(e.base62Id),state:{leavebehinds:n,uri:e.uri}}):null})})}const y=(0,o.lazy)((()=>n.e(9589).then(n.bind(n,39589)))),g="episode-sponsors-shelf",_="see-all-episode-sponsors";function T(e){const{numberOfSponsorsToDisplay:s}=function({numberOfSponsorsToDisplay:e=v}){return{numberOfSponsorsToDisplay:e}}(e),n=(0,t.W6)(r.XKk,{loadingValue:!1}),i=S({...e,numberOfSponsorsToDisplay:s});return i.episodeBase62Id&&i.displayedSponsors.length?(0,a.jsx)(o.Suspense,{fallback:!0,children:n?(0,a.jsx)(D,{state:i,uri:e.uri,base62Id:i.episodeBase62Id}):(0,a.jsx)(y,{...e,numberOfSponsorsToDisplay:s,state:i})}):null}const k=T},86447:(e,s,n)=>{n.d(s,{H:()=>t,b:()=>r});var o=n(31752);const t="episodeSponsorsStateWithRequiredProps";function r(){return(0,o.TH)()}},1568:(e,s,n)=>{n.d(s,{F:()=>i,m:()=>a});var o=n(59496),t=n(85830),r=n(1237);const i=420;function a({episodeBase62Id:e,getEpisodeSponsors:s,fetchedEpisodeSponsorsData:a=[],version:d}){const[u,p]=(0,o.useState)(a),c=(0,o.useCallback)((async()=>{try{if(!e)throw new Error("episodeBase62Id is required to fetch episode sponsors");const o=s??(await Promise.resolve().then(n.bind(n,78978))).getEpisodeSponsors;p(await o(e,{version:d}))}catch(e){p([])}}),[e,s,d]),l=(0,t.y1)(c,i);(0,o.useEffect)((function(){a.length||l()}),[l,a.length]);const f=(0,o.useCallback)((()=>({effectCallback:l})),[l]);return(0,r.H)(f),{fetchedEpisodeSponsorsData:u}}},83834:(e,s,n)=>{n.d(s,{X:()=>r});var o=n(59496),t=n(60375);function r({uri:e,reason:s,displayedEpisodeSponsorsData:r}){const i=(0,t.s4)(),a=(0,o.useCallback)((async o=>{const{createPodcastAdCtaCardEvent:t}=await n.e(1814).then(n.bind(n,64363));return i.send(t({uri:e,reason:s,lineitem_id:r.map((e=>e.metadata.lineitemId)),...o}))}),[e,r,s,i]);return(0,o.useEffect)((function(){a()}),[a]),a}},1237:(e,s,n)=>{n.d(s,{H:()=>u});var o=n(59496),t=n(97533),r=n(54940),i=n(36207),a=n(56961),d=n(52228);function u(e){const s=(0,t.W6)(r.oFA),n=(0,a.Y)((e=>{const s=e?.item??void 0;return(0,d.k6)(s)&&s.isPodcastAd?s.id??void 0:void 0})),u=(0,i.D)(n);(0,o.useEffect)((function(){const{effectCallback:o,destructor:t}=e();return n!==u&&Boolean(n)&&setTimeout(o,s),t}),[e,n,u,s])}},65313:(e,s,n)=>{n.d(s,{j:()=>p});var o=n(83687),t=n(30534),r=n(85389),i=n(13803),a=n(60375),d=n(88514),u=n(4637);const p=({leavebehinds:e,surface:s,uri:n,pathname:p,state:c})=>{const l=(0,a.s4)(),f=`${i.ag.get("view.see-all")} (${e.length<=d.fz?i.ag.formatNumber(e.length):i.ag.formatNumber(d.fz)})`;return(0,u.jsx)(o.rU,{to:p,state:c,children:(0,u.jsx)(t.o,{"data-testid":"leavebehinds-see-all",buttonSize:"sm",onClick:()=>{l.send((0,r.a)({leavebehind_request_id:e[0].requestId,event:"event_clicked",event_reason:"cta_see_all",surface:s,uri:n}))},children:f})})}}}]);
//# sourceMappingURL=4356.js.map