"use strict";(("undefined"!=typeof self?self:global).webpackChunkclient_web=("undefined"!=typeof self?self:global).webpackChunkclient_web||[]).push([[599,3711],{25115:(e,a,t)=>{t.d(a,{U:()=>o});var s=t(11808),r=t(70675),i=t(39796),n=t(86070);const o=({menu:e,onClick:a,"aria-label":t})=>(0,n.jsx)(i.b,{menu:e,children:(0,n.jsx)(r.e,{size:r.M.xs,label:s.Ru.get("more"),ariaLabel:t,onClick:a})})},23711:(e,a,t)=>{t.r(a),t.d(a,{CtaButton:()=>d,default:()=>c});var s=t(30758),r=t(72973),i=t(71306),n=t(43830),o=t(59996),l=t(86070);const d=({"aria-label":e,text:a,onClick:t,clickUrl:d,backgroundColor:c,className:m})=>{const u=(0,s.useMemo)((()=>{if(!c)return;const e=(0,r.mA)(c);return{...e,text:{...e.text,base:i.LLE}}}),[c]);return(0,l.jsx)(o.N,{"aria-label":e||a,className:m,"data-testid":"ad-cta-button",to:d,onClick:e=>{e.stopPropagation(),t()},children:(0,l.jsx)(n.$,{UNSAFE_colorSet:u,colorSet:"invertedLight",size:"small",children:a})})},c=d},90406:(e,a,t)=>{t.r(a),t.d(a,{HomeAdCard:()=>ze,default:()=>Fe});var s=t(30758),r=t(97500),i=t.n(r),n=t(435);const o={opacity:0,height:"0px"};function l({dismiss:e}){const[a,t]=(0,s.useState)(null),[r,i]=(0,s.useState)(0);(0,s.useEffect)((()=>{if(a){i(a.offsetHeight);const e=new ResizeObserver((()=>i(a.offsetHeight)));return e.observe(a),()=>e.disconnect()}return i(0),()=>{}}),[a]);const l=r?(e=>({opacity:1,height:`calc(${e}px + ${(0,n.po)("base")})`}))(r):o,d=(0,s.useRef)(null);return{setGridElement:t,shownHeight:r,transitionableStyles:l,containerRef:d,collapseHeightThenDismiss(){if(!d.current||!r)return void e();d.current.animate([l,o],{fill:"forwards",easing:"ease",duration:420}).onfinish=e}}}var d=t(11928),c=t(96705),m=t(11808),u=t(25115),y=t(23711),h=t(24226),f=t(1909),x=t(8331),v=t(66416),b=t(83542),g=t(95302),j=t(86070);const A=(0,s.memo)((function({onDismissAdClick:e}){return(0,j.jsx)(g.pZ,{value:"home-ad",children:(0,j.jsx)(v.W,{children:(0,j.jsx)(g.pZ,{value:"dismiss",children:(0,j.jsx)(b.D,{role:"menuitem",leadingIcon:(0,j.jsx)(x.P,{size:"small"}),"aria-label":m.Ru.get("ad-formats.context-menu.not-interested"),onClick:e,children:m.Ru.get("ad-formats.context-menu.not-interested")})})})})}));var k=t(39733),p=t(65876);const P="kvXKrQ08Ar7oAsMVJNOg",C="dBm03FPk9rHjecHq1Qnn",N=({className:e,homeAd:a,dismiss:t})=>{const s=(0,k.vh)(),r=(0,f.L)(),n=i()(P,e),{extractedHomeAdColor:[o]}=(0,h.bT)(),l=(0,p.A)((()=>{t(),r.log("collapsed",a),s.send((0,c.F)({ad_id:a.adId,advertiser:a.metadata.advertiser,creative_id:a.metadata.creative_id,event:"dislike_HPTO",format:(0,d.gh)(a.format),line_item_id:a.metadata.line_item_id}))})),x=(0,p.A)((()=>{r.log("clicked",a)})),v=a.metadata.buttonText||m.Ru.get("ad-formats.learnMore");return(0,j.jsxs)("div",{className:n,children:[a.clickthroughUrl&&(0,j.jsx)(y.CtaButton,{className:C,"aria-label":`${v}, link`,text:v,clickUrl:a.clickthroughUrl,onClick:x,backgroundColor:o?.colorDark}),(0,j.jsx)(u.U,{"aria-label":"More options, button",menu:(0,j.jsx)(A,{onDismissAdClick:l})})]})};var E=t(12783),R=t(59996);const U="lscHwwYXzt0CrEPAQgu3",_=({className:e,description:a,label:t,homeAd:s})=>{const r=i()(U,e),{clickthroughUrl:n,metadata:{tagline:o}}=s,l=(0,f.L)(),d=(0,p.A)((()=>{n&&l.log("clicked",s)}));return(0,j.jsxs)("div",{className:r,children:[t&&(0,j.jsx)(E.E,{variant:"bodyMedium",children:t}),o&&(0,j.jsx)(R.N,{to:n,onClick:d,"aria-label":`${o}, link`,children:(0,j.jsx)(E.E,{variant:"titleMedium",children:o})}),a&&(0,j.jsx)(E.E,{variant:"bodySmall",children:a})]})};var S=t(16047),w=t(24284),M=t(66060);const V="rLoSLtWsmOdhdiNz3r17",T=({className:e,homeAd:a})=>{const{metadata:{advertiser:t,logoImage:s},clickthroughUrl:r}=a,n=(0,f.L)(),o=(0,p.A)((()=>{r&&n.log("clicked",a)}));return(0,j.jsx)(R.N,{"aria-label":`${t}, Advertisement, link`,className:i()(e,V),to:r,onClick:o,children:(0,j.jsx)(S.v,{id:"advertiser-info",isInteractive:!1,media:s,padding:"0",subtitle:(0,j.jsx)(w.j,{children:m.Ru.get("ad-formats.advertisement")}),title:(0,j.jsx)(M.d,{children:t})})})};var H=t(68637),L=t(98670);const O="acMBKZuLlROUat0sL2a_",z=({className:e,icon:a,...t})=>(0,j.jsx)("div",{className:i()(O,e),...t,children:a});function F(e){const{imageUrlToExtractHomeAdColorFrom:[,a]}=(0,h.bT)();(0,s.useEffect)((()=>a(e)),[e,a]),(0,s.useEffect)((()=>()=>a(void 0)),[a])}var B=t(61544);function I(e){for(const{imageFileId:a,url:t}of e.display){if(a){const e=(0,B.CC)(a).toURI();if(e)return e}if(t)return t}}var D=t(57276);const W="lNTmTLY8RhoIIjrz4eyI",$=({className:e,displayAssetUrl:a,homeAd:t})=>{const r=(0,f.L)(),i=(0,p.A)((()=>{r.log("viewed",t)})),n=(0,p.A)((()=>{r.log("clicked",t)}));return(0,s.useEffect)((()=>i()),[i]),(0,j.jsx)(R.N,{to:t.clickthroughUrl,className:e,onClick:n,children:(0,j.jsx)(D._,{className:W,testid:"home-ad-display-asset",loading:"lazy",src:a,children:(0,j.jsx)(z,{icon:(0,j.jsx)(H.b,{})})})})},q=({className:e,homeAd:a})=>{const t=(0,s.useMemo)((()=>I(a)),[a]);return F(t),t?(0,j.jsx)($,{className:e,homeAd:a,displayAssetUrl:t}):(0,j.jsx)(z,{className:e,icon:(0,j.jsx)(L.c,{size:"large"}),"data-testid":"home-ad-display-asset-fallback"})};var X=t(16457);const G="JS7sJfGVY9xjxR3eWJVq",J=(0,s.memo)((({homeVideoAd:e})=>{const a=(0,s.useMemo)((()=>I(e)),[e]);return a?(0,j.jsx)($,{className:G,displayAssetUrl:a,homeAd:e}):(0,j.jsx)(z,{className:G,icon:(0,j.jsx)(H.b,{})})}));var Y=t(27931);var Z=t(95956);var Q=t(2435),K=t(72055);const ee=s.useState;var ae=t(65994);var te=t(43830),se=t(28875),re=t(41293),ie=t(94526),ne=t(1256),oe=t(99744);const le="oedSb2mjjyBaeN9twoSA",de="FLXTIzOmNsF6knFRXaZS",ce="GJ9evYudn2W7Lr5yMA5i",me="EjfHeXS7GNvs18SAYXe2",ue=({betamaxPlayer:e,muted:a,paused:t,isContextPlayerVideoPlaying:s,isContextPlayerPlaybackPaused:r})=>{const i=(0,oe.z)();return(0,j.jsxs)("div",{className:le,children:[(0,j.jsx)("div",{className:ce,children:a?(0,j.jsx)(te.$,{"aria-label":"Unmute, button",colorSet:"overMedia",iconOnly:se.X,onClick:()=>{e.setAudioDisabled(!1),!i.getState()?.item||s||r||i.pause()},size:"small"}):(0,j.jsx)(te.$,{"aria-label":"Mute, button",colorSet:"overMedia",iconOnly:re.z,onClick:()=>e.setAudioDisabled(!0),size:"small"})}),(0,j.jsx)("div",{className:me,children:t?(0,j.jsx)(te.$,{"aria-label":"Play, button",colorSet:"overMedia",iconOnly:ie.A,onClick:()=>{e.resume(),i.getState()?.item&&s&&!r&&i.pause()},size:"medium"}):(0,j.jsx)(te.$,{"aria-label":"Pause, button",className:de,colorSet:"overMedia",iconOnly:ne._,onClick:()=>e.pause(),size:"medium"})})]})};var ye=t(57523),he=t(71287),fe=t(68280);function xe(e,a,t){return new ye.A({mediaExtensions:[new he.h(e)],factories:[t]}).createBetamaxPlayer({videoElementConfig:{controls:!1,loop:!0},containerElement:a,networkConfiguration:{getAuthorizationHeader:async()=>{const{accessToken:e,tokenType:a}=await fe.l.get("sp://oauth/v2/token");return`${a} ${e}`}}})}async function ve(e,{mediaUrl:a,playback_id:t,playWhenReady:s}){return await e.play({mediaUrl:a,isRoyaltyMedia:!1,metadata:{playback_id:t}},{playWhenReady:s})}var be=t(97277);const ge="WJllnHWGxXydlZGNRZiO",je="r0vbWTxR_IGYTZyvgFMh",Ae=({assetUrl:e,homeVideoAd:a,videoContainerElement:t,createVideoPlayer:r=xe,playVideoPlayer:i=ve})=>{const{betamaxPlayer:n,setBetamaxPlayer:o}=function(){const[e,a]=ee((()=>Promise.resolve(void 0)));return{betamaxPlayer:e,setBetamaxPlayer:a}}(),l=(0,f.L)(),{isContextPlayerVideoPlaying:d,isContextPlayerPlaybackPaused:c}={isContextPlayerVideoPlaying:(0,Q.o)(K.A3),isContextPlayerPlaybackPaused:(0,Q.o)((e=>e?.isPaused))},m=!d||c,{muted:u,paused:y,loading:h,errored:x=!0,observerFactory:v}=function(e,a,t){const[r,i]=(0,s.useState)(!0),[n,o]=(0,s.useState)(!t),[l,d]=(0,s.useState)(!0),[c,m]=(0,s.useState)(!1);return{muted:r,paused:n,loading:l,errored:c,observerFactory:(0,s.useCallback)((()=>{let t=0;const s=(e,t)=>{a.log(e,t)},r=(e,a)=>{const r=(e=>{switch(e){case"started":return 1;case"first_quartile":return 2;case"midpoint":return 3;case"third_quartile":return 4;case"ended":case"error":return 5;default:return null}})(e);r?r>t&&(t=r,s(e,a)):s(e,a)};return{onStarted(){r("viewed",e),r("started",e),o(!1)},onResumed(){o((a=>(a&&r("resumed",e),!1)))},onPaused(){o(!0),r("paused",e)},onVolumeChanged({volume:a}){const t=a<=0;i(t),r(t?"muted":"unmuted",e)},onPlaybackCreated({timeObservable:a}){a.addObserverForMediaPositions([.25,.5,.75],(a=>{a>=.25&&r("first_quartile",e),a>=.5&&r("midpoint",e),a>=.75&&r("third_quartile",e)}))},onPlaybackEnded({reason:a}){switch(a){case ae.mT.FATAL_ERROR:case ae.mT.NETWORK_ERROR:r("error",e);break;case ae.mT.PLAYED_TO_END:r("ended",e)}},onReady(){d(!1)},onPlaybackError(){d(!1),m(!0)}}}),[e,a])}}(a,l,m),b=(0,s.useMemo)((()=>(0,be.U5)((0,be.sH)(a.adId))),[a.adId]),g=function({assetUrl:e,createVideoPlayer:a,playVideoPlayer:t,observerFactory:s,playback_id:r,playWhenReady:i,muted:n}){return(0,p.A)((async({videoContainerElement:o,"video-manifest-url":l})=>{try{return await t(a(l,o,s).setAudioDisabled(n),{mediaUrl:e,playback_id:r,playWhenReady:i})}catch(e){return}}))}({assetUrl:e,createVideoPlayer:r,playVideoPlayer:i,observerFactory:v,playback_id:b,playWhenReady:m,muted:u});return function({videoContainerElement:e,initializeBetamaxPlayer:a,setBetamaxPlayer:t}){const r=(0,Y.g)(),i=(0,s.useRef)(),n=(0,s.useRef)();(0,s.useEffect)((()=>{const s=r.getValues();i.current=s;const o=s.then((t=>{if(s===i.current){const s=t["video-manifest-url"];if(s)return a({videoContainerElement:e,"video-manifest-url":s})}}));n.current=o,t(o),o.then((e=>{o===n.current&&t(e)}))}),[a,e,t,r])}({videoContainerElement:t,initializeBetamaxPlayer:g,setBetamaxPlayer:o}),function({betamaxPlayer:e,assetUrl:a,playVideoPlayer:t,playback_id:r,playWhenReady:i}){const n=(0,p.A)((async a=>{e instanceof Z.M&&await t(e,{mediaUrl:a,playback_id:r,playWhenReady:i})}));(0,s.useEffect)((()=>{n(a)}),[a,n])}({betamaxPlayer:n,assetUrl:e,playVideoPlayer:i,playback_id:b,playWhenReady:m}),((e,a,t=!1)=>{(0,s.useEffect)((()=>{e instanceof Z.M&&!t&&(a?e.pause():e.setAudioDisabled(!0))}),[t,a,e])})(n,d,c),function({betamaxPlayer:e}){(0,s.useEffect)((()=>e&&e instanceof Z.M?()=>{e.release()}:void 0),[e])}({betamaxPlayer:n}),h||n&&"then"in n?(0,j.jsx)(z,{className:G,icon:(0,j.jsx)(X.a3,{"aria-label":"Loading"})}):x||!n?(0,j.jsx)(J,{homeVideoAd:a}):(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)("div",{className:je}),(0,j.jsx)(ue,{betamaxPlayer:n,muted:u,paused:y,isContextPlayerVideoPlaying:d,isContextPlayerPlaybackPaused:c})]})},ke=({assetUrl:e,className:a,homeVideoAd:t})=>{const[r,n]=(0,s.useState)(null);return F((0,s.useMemo)((()=>t.metadata.logoImage||I(t)),[t])),(0,j.jsx)("div",{"data-testid":"home-ad-video-asset",className:i()(ge,a),ref:n,children:r&&(0,j.jsx)(Ae,{homeVideoAd:t,assetUrl:e,videoContainerElement:r})})};var pe=t(39894);var Pe=t(12669),Ce=t(80454);function Ne({extractedHomeAdColor:e}){const{extractedHomeAdColor:[,a]}=(0,h.bT)();return(0,s.useEffect)((()=>a(e)),[e,a]),(0,s.useEffect)((()=>()=>a(void 0)),[a]),(0,Pe.z)(e.colorRaw),null}function Ee(){const{imageUrlToExtractHomeAdColorFrom:[e]}=(0,h.bT)(),a=(0,Ce.r)(e);return a?(0,j.jsx)(Ne,{extractedHomeAdColor:a}):null}var Re=t(78039),Ue=t(62413);const _e="gPtBODu_UjOYUZsXyVaw",Se="OMnQ68kGUatqLnLhldea",we="_lLWlErI3PPEoJh7DpgQ",Me="qwCxwlFGiJwd7y757EIC",Ve="n2TcVzKfe8w5qBzk_mHR",Te="iBi4L8rZvqCYwumUXiyQ",He="BbCl59l9jseBESAVkMFS",Le="_7BNL4Ovo2FE4OHUXD3b",Oe=(0,Re.H)((({homeAd:e,dismiss:a},t)=>{const r=(0,s.useMemo)((()=>{if(a=e,(0,d.pq)(a.format)===d.nM.VIDEO){const a=function(e){for(const{videoManifestId:a,url:t}of e.video){if(a){const e=pe.DJ.create(a);if(e)return e}if(t)return t}}(e);if(a)return{homeAd:e,videoAssetUrl:a}}var a}),[e]),{setGridElement:n,shownHeight:o,transitionableStyles:c,containerRef:m,collapseHeightThenDismiss:u}=l({dismiss:a});return(0,j.jsxs)("div",{className:_e,style:c,ref:e=>{m.current=e,"function"==typeof t?t(e):t&&(t.current=e)},"data-testid":"home-ad-card",children:[o&&(0,j.jsx)(Ee,{}),(0,j.jsx)("div",{className:i()(Se,{[we]:(0,Ue.A)()}),children:(0,j.jsxs)("div",{className:Me,ref:n,children:[r?(0,j.jsx)(ke,{className:Ve,homeVideoAd:r.homeAd,assetUrl:r.videoAssetUrl}):(0,j.jsx)(q,{className:Ve,homeAd:e}),(0,j.jsx)(T,{className:Te,homeAd:e}),(0,j.jsx)(_,{className:He,homeAd:e}),(0,j.jsx)(N,{className:Le,dismiss:u,homeAd:e})]})})]})})),ze=(0,Re.H)((({homeAd:e},a)=>{const{dismissed:t,dismiss:s}=(0,h.bT)();return t?null:(0,j.jsx)(Oe,{homeAd:e,dismiss:s,ref:a})})),Fe=ze},1909:(e,a,t)=>{t.d(a,{L:()=>r});var s=t(24226);const r=()=>{const{logger:e}=(0,s.bT)();return e}}}]);
//# sourceMappingURL=home-ad-card.js.map