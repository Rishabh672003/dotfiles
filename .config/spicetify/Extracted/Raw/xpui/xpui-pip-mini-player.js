"use strict";(("undefined"!=typeof self?self:global).webpackChunkopen=("undefined"!=typeof self?self:global).webpackChunkopen||[]).push([[1963],{96231:(e,t,i)=>{i.r(t),i.d(t,{PiPMiniPlayer:()=>he,TEST_IDS:()=>ge});var n=i(50959),o=i(84875),a=i.n(o),r=i(95206),l=i(58665),s=i(2997),c=i(98900),u=(i(48215),i(58431),i(20236)),d=i(74658),m=i(1689),k=i(11911),g=i(6215),h=i(42189),p=i(97432),C=i(29482),f=i(51203),x=i(31728),y=i(12708),v=i(13071),b=i(91433),w=i(20695);const j="gXC4vnPDiiiiawwnDN6i",S="HGOZPJuKeigRY5I0vqQw",B="AZLdtyFhMa1Aqml2YhF2",N="QfiWYSeXiPwGYmKED38q";var E=i(11527);const P=({item:e,onClick:t,className:i})=>{const n=(0,x.QR)(e),o=(0,g.k6)(e)?n?.title:e.name,r=(0,g.k6)(e)?n?.subtitle:e.name,l="SMALL"===(0,f.G)().vertical;return(0,E.jsxs)("div",{className:a()(j,i),children:[(0,E.jsx)("div",{className:S,children:(0,E.jsx)(b.R,{title:o,children:(0,E.jsx)(C.D,{"data-testid":"context-item-info-title",as:"div",variant:l?"ballad":"celloCanon",className:S,dir:"auto",children:(0,E.jsx)(v.b,{item:e,onClick:t,adUrl:n?.url,children:o})})},e.uri)}),(0,E.jsx)(w.t,{className:N,item:e}),(0,E.jsx)("div",{className:B,children:(0,E.jsx)(b.R,{title:r,children:(0,E.jsx)(C.D,{"data-testid":"context-item-info-subtitles",as:"div",variant:"mesto",className:B,semanticColor:"textSubdued",children:(0,E.jsx)(y._,{item:e,onClick:t,adSubtitle:r,adBlurbUri:n?.blurbUri,adUrl:n?.url?n?.url:void 0})})},e.uri)})]})};var R=i(31254),T=i(49857),F=i(90460),I=i(9974),V=i(45255),O=i(3578),L=i(81214),_=i(70712),A=i(72746),D=i(49420),M=i(93462);function H(e){return{itemToBeSkipped:e.item?.uri||"",positionMs:(0,D.k)(e)??-1,totalContentMs:e.duration??-1}}function W(e){return Math.floor(100*e)}const z="E7rR1kkQFoqCTrZAxs8l",U="I2v17dp_FDztHzG7CZy9",q="H5VJw6yCxUOoh88LJ42y",G=n.memo((({item:e,spec:t,logger:i})=>{const o=e.uri,{onClickPlayPause:a,onClickLike:r,onClickSkipPrevious:l,onClickSkipNext:s,onClickRepeat:c,onClickShuffle:u,onClickVolumeButton:d,onClickVolumeBar:m,onDragVolumeBar:k,onClickSeekBack:h,onClickSeekForward:p}=(({uri:e,spec:t,logger:i})=>{const o=(0,n.useRef)(e);o.current=e;const a=(0,A.g)(),r=(0,n.useMemo)((()=>t.playerControlsFactory()),[t]),l=(0,n.useCallback)((e=>{let t=null;o.current&&("pause"===e?t=r.playPauseButtonFactory().hitPause({itemToBePaused:o.current}):"resume"===e&&(t=r.playPauseButtonFactory().hitResume({itemToBeResumed:o.current})),t&&i.logInteraction(t))}),[i,r]),s=(0,n.useCallback)((e=>{if(!o.current)return;const t=r.likeButtonFactory(),n=e?t.hitLike({itemToBeLiked:o.current}):t.hitRemoveLike({itemNoLongerLiked:o.current});i.logInteraction(n)}),[i,r]),c=(0,n.useCallback)((()=>{const e=a.getState();if(!e)return;const t=r.previousButtonFactory().hitSkipToPrevious(H(e));i.logInteraction(t)}),[i,a,r]),u=(0,n.useCallback)((()=>{const e=a.getState();if(!e)return;const t=r.nextButtonFactory().hitSkipToNext(H(e));i.logInteraction(t)}),[i,a,r]),d=(0,n.useCallback)((e=>{const t=r.repeatButtonFactory();let n=null;switch(e){case g.zq.REPEAT_TRACK:n=t.hitRepeatOneEnable();break;case g.zq.REPEAT_CONTEXT:n=t.hitRepeatEnable();break;case g.zq.REPEAT_NONE:n=t.hitRepeatDisable();break;default:(0,M._)(e)}n&&i.logInteraction(n)}),[i,r]),m=(0,n.useCallback)((e=>{if(!o.current)return;const t=e?"shuffle":"linear",n=e?"linear":"shuffle",a=r.shuffleButtonFactory({uri:o.current}).hitSelectShuffleMode({previousMode:n,selectedMode:t});i.logInteraction(a)}),[i,r]),k=(0,n.useCallback)((e=>{const t=r.volumeMuteButtonFactory();i.logInteraction("muted"===e?t.hitMutePlayback():t.hitUnmutePlayback())}),[i,r]),h=(0,n.useCallback)((e=>{const t=r.volumeBarFactory();i.logInteraction(t.hitSetVolume({newVolumePercentage:W(e)}))}),[i,r]),p=(0,n.useCallback)((e=>{const t=r.volumeBarFactory();i.logInteraction(t.dragSetVolume({newVolumePercentage:W(e)}))}),[i,r]),C=(0,n.useCallback)((e=>{const t=r.seekBackwardButtonFactory();i.logInteraction(t.hitSeekByTime({msSeekedOffset:e}))}),[i,r]);return{onClickSeekForward:(0,n.useCallback)((e=>{const t=r.seekForwardButtonFactory();i.logInteraction(t.hitSeekByTime({msSeekedOffset:e}))}),[i,r]),onClickSeekBack:C,onClickPlayPause:l,onClickLike:s,onClickSkipPrevious:c,onClickSkipNext:u,onClickRepeat:d,onClickShuffle:m,onClickVolumeButton:k,onClickVolumeBar:h,onDragVolumeBar:p}})({uri:o,spec:t,logger:i}),C=(0,f.G)(),x=(0,T.y1)(k,500,{leading:!1,trailing:!0});if(!o)return null;const y=(0,I.G)(e),v=(0,F.i)(e),b=function(e){if((0,F.i)(e)||(0,g.G7)(e))return"audio"===e.mediaType||"mixed"===e.mediaType;return!1}(e),w="SMALL"===C.horizontal;return"SMALL"===C.vertical?(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)(L.IF,{onClick:a}),b?(0,E.jsx)(L.Of,{onClick:p}):(0,E.jsx)(L.C$,{onClick:s})]}):(0,E.jsxs)(E.Fragment,{children:[(0,E.jsxs)("div",{className:z,children:[y&&(0,E.jsx)(O.B,{uri:o,onClick:r,className:U}),v&&(0,E.jsx)(V.w,{uri:o,onClick:r,className:U})]}),b?(0,E.jsx)(L.FP,{onClick:h}):(0,E.jsx)(L.P4,{onClick:u}),(0,E.jsx)(L.Wu,{onClick:l}),(0,E.jsx)(L.IF,{iconSize:w?"small":"medium",onClick:a,className:q}),(0,E.jsx)(L.C$,{onClick:s}),b?(0,E.jsx)(L.Of,{onClick:p}):(0,E.jsx)(L.$Z,{onClick:c}),(0,E.jsx)(_.h,{mode:_.R.SHOW_SLIDER_ON_HOVER,sliderSize:80,sliderDirection:"vertical",onToggleMuteClick:d,onVolumeBarClick:m,onVolumeBarDrag:x})]})}));var K=i(74818),Z=i(61441),Q=i(41342),X=i(49784),Y=i(43049);var J=i(28106);var $=i(67911);function ee(e){if(!e)return null;return{width:e.innerWidth,height:e.innerHeight}}const te="transparent",ie="AFZj_hxk7gFsvDDwhsHA",ne="UJwngpM5puDW7Frkha4F",oe="ktiXGqfcVuegTncUQJim",ae="EzVSQ6md_ZPcpGd373uw",re="xM5DXnNVIBKl0D8KmkKr",le="xZLIxv5s2tm_tmFk3WK8",se="X_fBDy8Kj2NkVB4npQT3",ce="yMMglN43dvX2QKTUoivA",ue="D0BU1OBnl1EjBDosrWXn",de="tKfqdd6glswVG49yHgiT",me="Hbbk972I34uVuWeqBn2Q",ke="xI3ObXOh1ql5ZWoAUyff",ge={HOVER_CONTAINER:"document-pip-hover-element",COVER_ART:"document-pip-cover-art",COVER_ART_PLACEHOLDER:"document-pip-cover-art-placeholder"},he=n.memo((()=>{const{item:e,context:t}=(0,Z.x)()??{},[i,o]=(0,n.useState)(!1),C=640,f=(0,n.useMemo)((()=>(0,p.o)(e?.images??void 0,{desiredSize:C})),[e?.images,C]),x=(0,m.b)(f,te),y=(0,l.W6)(K.YZd);((e,t)=>{const i=(0,J.Y)((e=>e?.nextItems?.[0]),((e,t)=>e?.uri===t?.uri)),o=(0,n.useMemo)((()=>(0,p.o)(i?.images??void 0,{desiredSize:e})),[i?.images,e]);(0,m.b)(o,t)})(C,te);const{spec:v,logger:b}=(0,h.fU)(s.O,{}),w=(0,h.Wi)(v);(({spec:e,logger:t})=>{const i=(0,Y.zY)(),o=(0,n.useRef)(null);null===o.current&&(o.current=ee(i)),(0,$.a)((()=>{const n=ee(i);null!==n&&null!==o.current&&(t.logInteraction(e.dragUiResize2d({startWidthPx:o.current.width,startHeightPx:o.current.height,endWidthPx:n.width,endHeightPx:n.height})),o.current=n)}),{throttleTime:500,leading:!1,trailing:!0})})({logger:b,spec:v}),(({spec:e,logger:t,pipWindow:i})=>{(0,n.useEffect)((()=>{if(!i)return;const n=n=>{if(n.currentTarget===i){const i=e.windowControlsFactory().closeButtonFactory().hitUiHide();t.logInteraction(i)}};return i.addEventListener("pagehide",n),()=>{i.removeEventListener("pagehide",n)}}),[t,i,e])})({logger:b,spec:v,pipWindow:window.documentPictureInPicture?.window??null});const{setVideoPlayerUIFlag:j}=(0,Q.l)(),{isPlayingRemotely:S}=(0,k.H)(),[B,N]=(0,n.useState)("");(0,n.useLayoutEffect)((()=>{N(ne)}),[]),(0,n.useEffect)((()=>{y&&j(X.x.documentPip,!0)}),[y,j]);const T=(0,n.useCallback)((e=>{var t;(t=e.target)&&"object"==typeof t&&"nodeName"in t&&"A"===t.nodeName&&"_blank"!==e.target.target&&("showMainWindow"in window?window.showMainWindow?.():o(!0))}),[]);if(((e,t)=>{const i=(0,Y.zY)(),o=t??i;(0,n.useEffect)((()=>{e&&o&&(o.document.title=e)}),[e,o])})(c.ag.get("web-player.pip-mini-player.window-title")),(0,n.useEffect)((()=>{if(i){const e=setTimeout((()=>{o(!1)}),3e3);return()=>{clearTimeout(e)}}}),[i]),!e||!t)return null;const F={"--background-color":x,"--background-image-url":`url(${f})`,"--background-image-width":"640px","--background-image-height":"640px",display:"var(--mini-player-display)"},I=function(e){return"video"===e.mediaType||"mixed"===e.mediaType}(e);let V=!I;return!I||!S&&y||(V=!0),(0,E.jsxs)("div",{className:ie,style:{"--mini-player-display":"none"},children:[(0,E.jsxs)("div",{className:a()("encore-dark-theme",oe),style:F,ref:w,children:[(0,E.jsx)("div",{className:a()(re,{[le]:!I}),"data-testid":"pip-hover-element",children:(0,E.jsx)("div",{className:se,id:"document-pip-main-container",children:V&&(0,E.jsx)(d.Ee,{className:ce,src:f,loading:"eager",testid:ge.COVER_ART,children:(0,E.jsx)("div",{className:ue,children:(0,E.jsx)(u.t,{size:"xlarge",type:e.type,"data-testid":ge.COVER_ART_PLACEHOLDER})})})})}),(0,E.jsx)(P,{item:e,className:ke,onClick:T}),(0,E.jsx)("div",{className:a()("encore-over-media-set",de,{[me]:!(0,g.k6)(e)}),dir:"ltr","data-testid":ge.HOVER_CONTAINER,children:(0,E.jsx)(G,{item:e,spec:v,logger:b})})]}),(0,E.jsx)("div",{className:B,children:(0,E.jsx)(R.E,{fadeIn:!1})}),(0,E.jsx)(r.A9,{colorSet:"invertedLight",showSnackbar:i,className:ae,children:c.ag.get("web-player.pip-mini-player.snackbar.link-opened-in-main-window")})]})}))}}]);
//# sourceMappingURL=xpui-pip-mini-player.js.map